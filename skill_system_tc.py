"""
스킬 시스템 아이템 장착 관련 테스트케이스 자동 생성 스크립트
기획서 내용을 모두 인지한 후 완벽한 테스트케이스를 생성합니다.
"""

import pandas as pd
import os
from datetime import datetime

# 테스트케이스 데이터 정의
def generate_skill_equipment_testcases():
    """
    스킬 시스템의 아이템 장착 관련 테스트케이스를 생성합니다.
    
    Returns:
        테스트케이스 목록 (dictionary 형태)
    """
    testcases = [
        # 1. 기본 장착 기능
        {
            "대분류": "스킬 시스템",
            "중분류": "아이템 장착",
            "소분류": "장착 기능",
            "확인내용": "인벤토리에서 장비 슬롯으로 아이템을 드래그 앤 드롭하여 정상적으로 장착되는지 확인",
            "결과": "",
            "JIRA": "",
            "AD": "",
            "iOS": "",
            "PC": "",
            "비고": "모든 장비 슬롯 유형 검증 (무기, 방어구, 장신구)"
        },
        {
            "대분류": "스킬 시스템",
            "중분류": "아이템 장착",
            "소분류": "장착 기능",
            "확인내용": "장비 아이콘 더블 클릭으로 해당 슬롯에 자동 장착되는지 확인",
            "결과": "",
            "JIRA": "",
            "AD": "",
            "iOS": "",
            "PC": "",
            "비고": "모바일에서는 탭 동작 확인"
        },
        {
            "대분류": "스킬 시스템",
            "중분류": "아이템 장착",
            "소분류": "장착 해제",
            "확인내용": "장착된 장비 슬롯을 클릭하여 아이템이 정상적으로 해제되는지 확인",
            "결과": "",
            "JIRA": "",
            "AD": "",
            "iOS": "",
            "PC": "",
            "비고": "해제된 아이템이 인벤토리로 이동됨"
        },
        
        # 2. 외형 및 시각적 피드백
        {
            "대분류": "스킬 시스템",
            "중분류": "아이템 장착",
            "소분류": "캐릭터 외형",
            "확인내용": "무기 장착 시 캐릭터 모델에 해당 무기가 올바르게 표시되는지 확인",
            "결과": "",
            "JIRA": "",
            "AD": "",
            "iOS": "",
            "PC": "",
            "비고": "무기 위치, 크기, 각도 검증"
        },
        {
            "대분류": "스킬 시스템",
            "중분류": "아이템 장착",
            "소분류": "캐릭터 외형",
            "확인내용": "방어구 장착 시 캐릭터 외형이 해당 방어구 모델로 변경되는지 확인",
            "결과": "",
            "JIRA": "",
            "AD": "",
            "iOS": "",
            "PC": "",
            "비고": "여러 부위 동시 장착 시 모든 부위 검증"
        },
        {
            "대분류": "스킬 시스템",
            "중분류": "아이템 장착",
            "소분류": "UI 피드백",
            "확인내용": "장착 가능 아이템이 인벤토리에서 녹색 테두리로 표시되는지 확인",
            "결과": "",
            "JIRA": "",
            "AD": "",
            "iOS": "",
            "PC": "",
            "비고": "요구 레벨, 클래스 조건 충족 시"
        },
        {
            "대분류": "스킬 시스템",
            "중분류": "아이템 장착",
            "소분류": "UI 피드백",
            "확인내용": "장착 불가 아이템이 인벤토리에서 빨간색 테두리로 표시되는지 확인",
            "결과": "",
            "JIRA": "",
            "AD": "",
            "iOS": "",
            "PC": "",
            "비고": "요구 레벨, 클래스 조건 미충족 시"
        },
        {
            "대분류": "스킬 시스템",
            "중분류": "아이템 장착",
            "소분류": "UI 피드백",
            "확인내용": "현재 장착 중인 아이템이 인벤토리에서 황금색 테두리로 하이라이트되는지 확인",
            "결과": "",
            "JIRA": "",
            "AD": "",
            "iOS": "",
            "PC": "",
            "비고": "인벤토리를 닫았다 열어도 유지되는지 확인"
        },
        
        # 3. 능력치 영향 및 스탯 증가
        {
            "대분류": "스킬 시스템",
            "중분류": "아이템 장착",
            "소분류": "능력치 증가",
            "확인내용": "공격력 증가 효과가 있는 아이템 장착 시 캐릭터 정보창에 공격력이 정확히 증가하는지 확인",
            "결과": "",
            "JIRA": "",
            "AD": "",
            "iOS": "",
            "PC": "",
            "비고": "기본 공격력 + 아이템 효과 = 최종 공격력"
        },
        {
            "대분류": "스킬 시스템",
            "중분류": "아이템 장착",
            "소분류": "능력치 증가",
            "확인내용": "방어력 증가 효과가 있는 아이템 장착 시 캐릭터 정보창에 방어력이 정확히 증가하는지 확인",
            "결과": "",
            "JIRA": "",
            "AD": "",
            "iOS": "",
            "PC": "",
            "비고": "기본 방어력 + 아이템 효과 = 최종 방어력"
        },
        {
            "대분류": "스킬 시스템",
            "중분류": "아이템 장착",
            "소분류": "능력치 증가",
            "확인내용": "체력 증가 효과가 있는 아이템 장착 시 캐릭터 정보창에 최대 체력이 정확히 증가하는지 확인",
            "결과": "",
            "JIRA": "",
            "AD": "",
            "iOS": "",
            "PC": "",
            "비고": "기본 체력 + 아이템 효과 = 최종 체력"
        },
        {
            "대분류": "스킬 시스템",
            "중분류": "아이템 장착",
            "소분류": "특수 능력치",
            "확인내용": "치명타 확률 증가 아이템 장착 시 캐릭터 정보창에 치명타 확률이 정확히 반영되는지 확인",
            "결과": "",
            "JIRA": "",
            "AD": "",
            "iOS": "",
            "PC": "",
            "비고": "여러 아이템의 중첩 효과 검증"
        },
        
        # 4. 스킬 영향 및 강화
        {
            "대분류": "스킬 시스템",
            "중분류": "아이템 장착",
            "소분류": "스킬 강화",
            "확인내용": "특정 스킬 데미지 증가 효과가 있는 아이템 장착 시 해당 스킬의 데미지가 증가하는지 확인",
            "결과": "",
            "JIRA": "",
            "AD": "",
            "iOS": "",
            "PC": "",
            "비고": "스킬 툴팁 및 실제 데미지 모두 확인"
        },
        {
            "대분류": "스킬 시스템",
            "중분류": "아이템 장착",
            "소분류": "스킬 강화",
            "확인내용": "스킬 쿨타임 감소 효과가 있는 아이템 장착 시 해당 스킬의 재사용 대기시간이 감소하는지 확인",
            "결과": "",
            "JIRA": "",
            "AD": "",
            "iOS": "",
            "PC": "",
            "비고": "스킬 툴팁 및 실제 쿨타임 모두 확인"
        },
        {
            "대분류": "스킬 시스템",
            "중분류": "아이템 장착",
            "소분류": "스킬 시각화",
            "확인내용": "스킬 강화 효과가 있는 아이템 장착 시 스킬창에서 해당 스킬 아이콘에 강화 효과가 표시되는지 확인",
            "결과": "",
            "JIRA": "",
            "AD": "",
            "iOS": "",
            "PC": "",
            "비고": "테두리 색상, 이펙트 확인"
        },
        {
            "대분류": "스킬 시스템",
            "중분류": "아이템 장착",
            "소분류": "스킬 해금",
            "확인내용": "특정 스킬 해금 효과가 있는 아이템 장착 시 해당 스킬이 사용 가능해지는지 확인",
            "결과": "",
            "JIRA": "",
            "AD": "",
            "iOS": "",
            "PC": "",
            "비고": "스킬창에 새 스킬 표시 및 사용 가능 상태 확인"
        },
        
        # 5. 세트 효과
        {
            "대분류": "스킬 시스템",
            "중분류": "아이템 장착",
            "소분류": "세트 효과",
            "확인내용": "동일 세트의 아이템 2개 장착 시 2세트 효과가 캐릭터에 적용되는지 확인",
            "결과": "",
            "JIRA": "",
            "AD": "",
            "iOS": "",
            "PC": "",
            "비고": "세트 효과 툴팁 및 실제 능력치 증가 확인"
        },
        {
            "대분류": "스킬 시스템",
            "중분류": "아이템 장착",
            "소분류": "세트 효과",
            "확인내용": "동일 세트의 아이템 4개 장착 시 4세트 효과가 추가로 적용되는지 확인",
            "결과": "",
            "JIRA": "",
            "AD": "",
            "iOS": "",
            "PC": "",
            "비고": "2세트 효과와 4세트 효과 모두 적용되는지 확인"
        },
        {
            "대분류": "스킬 시스템",
            "중분류": "아이템 장착",
            "소분류": "세트 효과",
            "확인내용": "세트 아이템 장착 시 캐릭터 주변에 해당 세트의 특수 이펙트가 표시되는지 확인",
            "결과": "",
            "JIRA": "",
            "AD": "",
            "iOS": "",
            "PC": "",
            "비고": "세트 단계별 이펙트 변화 확인"
        },
        {
            "대분류": "스킬 시스템",
            "중분류": "아이템 장착",
            "소분류": "세트 효과 UI",
            "확인내용": "세트 효과 활성화 시 세트 정보창에 활성화된 세트와 효과가 표시되는지 확인",
            "결과": "",
            "JIRA": "",
            "AD": "",
            "iOS": "",
            "PC": "",
            "비고": "활성화 단계 및 다음 단계 요구 개수 표시 확인"
        },
        {
            "대분류": "스킬 시스템",
            "중분류": "아이템 장착",
            "소분류": "세트 스킬",
            "확인내용": "세트 완성 시 특수 스킬이 해금되고 스킬창에 표시되는지 확인",
            "결과": "",
            "JIRA": "",
            "AD": "",
            "iOS": "",
            "PC": "",
            "비고": "특수 스킬의 사용 가능 여부 확인"
        },
        
        # 6. 장착 제한 조건
        {
            "대분류": "스킬 시스템",
            "중분류": "아이템 장착",
            "소분류": "레벨 제한",
            "확인내용": "캐릭터 레벨이 아이템 요구 레벨보다 낮을 때 장착이 제한되고 적절한 안내 메시지가 표시되는지 확인",
            "결과": "",
            "JIRA": "",
            "AD": "",
            "iOS": "",
            "PC": "",
            "비고": "정확한 요구 레벨 표시 확인"
        },
        {
            "대분류": "스킬 시스템",
            "중분류": "아이템 장착",
            "소분류": "클래스 제한",
            "확인내용": "다른 클래스 전용 아이템 장착 시도 시 제한되고 적절한 안내 메시지가 표시되는지 확인",
            "결과": "",
            "JIRA": "",
            "AD": "",
            "iOS": "",
            "PC": "",
            "비고": "요구 클래스 정보 표시 확인"
        },
        {
            "대분류": "스킬 시스템",
            "중분류": "아이템 장착",
            "소분류": "스탯 제한",
            "확인내용": "요구 스탯이 부족할 때 장착이 제한되고 적절한 안내 메시지가 표시되는지 확인",
            "결과": "",
            "JIRA": "",
            "AD": "",
            "iOS": "",
            "PC": "",
            "비고": "현재 스탯과 요구 스탯 비교 정보 표시"
        },
        
        # 7. 장비 교체 및 변경
        {
            "대분류": "스킬 시스템",
            "중분류": "아이템 장착",
            "소분류": "장비 교체",
            "확인내용": "이미 장착된 슬롯에 새 아이템 장착 시 확인 다이얼로그가 표시되는지 확인",
            "결과": "",
            "JIRA": "",
            "AD": "",
            "iOS": "",
            "PC": "",
            "비고": "확인/취소 선택 가능 확인"
        },
        {
            "대분류": "스킬 시스템",
            "중분류": "아이템 장착",
            "소분류": "장비 교체",
            "확인내용": "장비 교체 확인 후 기존 아이템이 인벤토리로 이동하고 새 아이템이 장착되는지 확인",
            "결과": "",
            "JIRA": "",
            "AD": "",
            "iOS": "",
            "PC": "",
            "비고": "인벤토리 공간 부족 시 처리 확인"
        },
        {
            "대분류": "스킬 시스템",
            "중분류": "아이템 장착",
            "소분류": "무기 교체",
            "확인내용": "양손 무기 장착 시 보조무기/방패가 자동으로 해제되고 안내 메시지가 표시되는지 확인",
            "결과": "",
            "JIRA": "",
            "AD": "",
            "iOS": "",
            "PC": "",
            "비고": "해제된 아이템이 인벤토리로 이동 확인"
        },
        
        # 8. 특수 상황 및 예외 처리
        {
            "대분류": "스킬 시스템",
            "중분류": "아이템 장착",
            "소분류": "내구도 관리",
            "확인내용": "내구도가 0인 파괴된 아이템 장착 시도 시 제한되고 수리 안내가 표시되는지 확인",
            "결과": "",
            "JIRA": "",
            "AD": "",
            "iOS": "",
            "PC": "",
            "비고": "수리 버튼 기능 및 수리 비용 표시 확인"
        },
        {
            "대분류": "스킬 시스템",
            "중분류": "아이템 장착",
            "소분류": "고유 아이템 제한",
            "확인내용": "'고유 장착' 제한이 있는 아이템을 중복 장착 시도 시 제한되고 안내가 표시되는지 확인",
            "결과": "",
            "JIRA": "",
            "AD": "",
            "iOS": "",
            "PC": "",
            "비고": "이미 장착된 고유 아이템 위치 표시 확인"
        },
        {
            "대분류": "스킬 시스템",
            "중분류": "아이템 장착",
            "소분류": "임시 효과 아이템",
            "확인내용": "시간 제한이 있는 아이템 장착 시 남은 시간이 툴팁에 표시되는지 확인",
            "결과": "",
            "JIRA": "",
            "AD": "",
            "iOS": "",
            "PC": "",
            "비고": "실시간 남은 시간 갱신 및 시간 경과 시 자동 해제 확인"
        },
        {
            "대분류": "스킬 시스템",
            "중분류": "아이템 장착",
            "소분류": "인벤토리 관리",
            "확인내용": "인벤토리가 가득 찬 상태에서 장착 아이템 해제 시 적절한 경고 메시지가 표시되는지 확인",
            "결과": "",
            "JIRA": "",
            "AD": "",
            "iOS": "",
            "PC": "",
            "비고": "인벤토리 공간 확보 후 해제 가능 확인"
        },
        
        # 9. 스킬 특화 장비 효과 테스트
        {
            "대분류": "스킬 시스템",
            "중분류": "아이템 장착",
            "소분류": "속성 부여",
            "확인내용": "속성 부여 효과가 있는 무기 장착 시 스킬에 해당 속성이 추가되고 데미지에 반영되는지 확인",
            "결과": "",
            "JIRA": "",
            "AD": "",
            "iOS": "",
            "PC": "",
            "비고": "스킬 색상 변경 및 추가 효과 확인"
        },
        {
            "대분류": "스킬 시스템",
            "중분류": "아이템 장착",
            "소분류": "쿨타임 감소",
            "확인내용": "쿨타임 감소 효과가 있는 아이템 여러 개 장착 시 중첩 효과가 올바르게 적용되는지 확인",
            "결과": "",
            "JIRA": "",
            "AD": "",
            "iOS": "",
            "PC": "",
            "비고": "중첩 효과 제한(있을 경우) 확인"
        },
        {
            "대분류": "스킬 시스템",
            "중분류": "아이템 장착",
            "소분류": "스킬 변형",
            "확인내용": "스킬 변형 효과가 있는 아이템 장착 시 해당 스킬의 동작이 변경되는지 확인",
            "결과": "",
            "JIRA": "",
            "AD": "",
            "iOS": "",
            "PC": "",
            "비고": "단일 대상→범위, 즉발→지속 등 변형 확인"
        },
        {
            "대분류": "스킬 시스템",
            "중분류": "아이템 장착",
            "소분류": "조건부 스킬 강화",
            "확인내용": "특정 조건 만족 시 스킬 강화 효과가 발동되는 아이템 장착 시 조건 충족 시 효과가 적용되는지 확인",
            "결과": "",
            "JIRA": "",
            "AD": "",
            "iOS": "",
            "PC": "",
            "비고": "체력 비율, 시간대 등 조건 기반 확인"
        },
        {
            "대분류": "스킬 시스템",
            "중분류": "아이템 장착",
            "소분류": "스킬 연계 강화",
            "확인내용": "연속 스킬 사용 시 효과가 강화되는 아이템 장착 후 스킬 연계 시 효과가 적용되는지 확인",
            "결과": "",
            "JIRA": "",
            "AD": "",
            "iOS": "",
            "PC": "",
            "비고": "연계 효과 UI 표시 및 데미지 증가 확인"
        },
        
        # 10. 캐릭터 클래스별 특화 효과
        {
            "대분류": "스킬 시스템",
            "중분류": "아이템 장착",
            "소분류": "전사 특화",
            "확인내용": "전사 특화 세트 아이템 장착 시 방어/체력 관련 효과가 올바르게 적용되는지 확인",
            "결과": "",
            "JIRA": "",
            "AD": "",
            "iOS": "",
            "PC": "",
            "비고": "분노 게이지 효과 등 클래스 리소스 영향 확인"
        },
        {
            "대분류": "스킬 시스템",
            "중분류": "아이템 장착",
            "소분류": "마법사 특화",
            "확인내용": "마법사 특화 세트 아이템 장착 시 마법 데미지/마나 관련 효과가 올바르게 적용되는지 확인",
            "결과": "",
            "JIRA": "",
            "AD": "",
            "iOS": "",
            "PC": "",
            "비고": "마나 회복, 시전 시간 효과 확인"
        },
        {
            "대분류": "스킬 시스템",
            "중분류": "아이템 장착",
            "소분류": "궁수 특화",
            "확인내용": "궁수 특화 세트 아이템 장착 시 치명타/회피 관련 효과가 올바르게 적용되는지 확인",
            "결과": "",
            "JIRA": "",
            "AD": "",
            "iOS": "",
            "PC": "",
            "비고": "명중률, 치명타 데미지 효과 확인"
        },
        
        # 11. 네트워크 관련 테스트
        {
            "대분류": "스킬 시스템",
            "중분류": "아이템 장착",
            "소분류": "서버 지연",
            "확인내용": "네트워크 지연 상황에서 아이템 장착 시 로딩 인디케이터가 표시되고 완료 후 결과가 반영되는지 확인",
            "결과": "",
            "JIRA": "",
            "AD": "",
            "iOS": "",
            "PC": "",
            "비고": "타임아웃 처리 및 재시도 옵션 확인"
        },
        {
            "대분류": "스킬 시스템",
            "중분류": "아이템 장착",
            "소분류": "동기화",
            "확인내용": "클라이언트-서버 간 아이템 정보 불일치 발생 시 자동 재동기화가 정상 작동하는지 확인",
            "결과": "",
            "JIRA": "",
            "AD": "",
            "iOS": "",
            "PC": "",
            "비고": "동기화 과정 UI 및 완료 후 상태 확인"
        },
        
        # 12. 플랫폼별 특화 테스트
        {
            "대분류": "스킬 시스템",
            "중분류": "아이템 장착",
            "소분류": "모바일 UI",
            "확인내용": "모바일 디바이스에서 장비 장착 UI가 화면 크기에 맞게 최적화되어 표시되는지 확인",
            "결과": "",
            "JIRA": "",
            "AD": "",
            "iOS": "",
            "PC": "",
            "비고": "터치 인터랙션 및 제스처 지원 확인"
        },
        {
            "대분류": "스킬 시스템",
            "중분류": "아이템 장착",
            "소분류": "PC UI",
            "확인내용": "PC에서 마우스 오버 시 아이템 비교 툴팁이 올바르게 표시되는지 확인",
            "결과": "",
            "JIRA": "",
            "AD": "",
            "iOS": "",
            "PC": "",
            "비고": "키보드 단축키 지원 확인"
        }
    ]
    
    return testcases

def export_to_excel(testcases, output_path="skill_system_testcases.xlsx"):
    """
    테스트케이스를 엑셀 파일로 내보냅니다.
    
    Args:
        testcases: 테스트케이스 목록
        output_path: 출력 파일 경로
    """
    # DataFrame 생성
    df = pd.DataFrame(testcases)
    
    # 현재 날짜/시간 추가
    timestamp = datetime.now().strftime("%Y%m%d_%H%M%S")
    file_path = f"{output_path.split('.')[0]}_{timestamp}.xlsx"
    
    # 엑셀 작성자 생성
    with pd.ExcelWriter(file_path, engine='openpyxl') as writer:
        # 데이터 시작 위치를 8행으로 조정 (상단에 통계 영역 추가)
        df.to_excel(writer, index=False, sheet_name="스킬 시스템", startrow=7)
        
        # 워크시트 가져오기
        worksheet = writer.sheets["스킬 시스템"]
        
        # 상단 통계 영역 추가
        total_count = len(testcases)
        pass_count = sum(1 for tc in testcases if tc.get('AD', '') == 'PASS' or tc.get('iOS', '') == 'PASS' or tc.get('PC', '') == 'PASS')
        fail_count = sum(1 for tc in testcases if tc.get('AD', '') == 'FAIL' or tc.get('iOS', '') == 'FAIL' or tc.get('PC', '') == 'FAIL')
        not_tested_count = total_count - pass_count - fail_count
        
        worksheet.cell(row=2, column=2, value="QA T/C 총 현황")
        worksheet.cell(row=2, column=3, value="QA T/C 총 현황")
        worksheet.cell(row=2, column=7, value="QA 진행률")
        worksheet.cell(row=2, column=8, value="미진행")
        worksheet.cell(row=3, column=2, value="통과")
        worksheet.cell(row=3, column=3, value=pass_count)
        worksheet.cell(row=3, column=7, value="미진행")
        worksheet.cell(row=4, column=2, value="실패")
        worksheet.cell(row=4, column=3, value=fail_count)
        worksheet.cell(row=4, column=7, value="PASS")
        worksheet.cell(row=5, column=2, value="테스트 전")
        worksheet.cell(row=5, column=3, value=not_tested_count)
        worksheet.cell(row=5, column=7, value="BLOCKED")
        worksheet.cell(row=6, column=2, value="전체 개수")
        worksheet.cell(row=6, column=3, value=total_count)
        worksheet.cell(row=6, column=7, value="FAIL")
        worksheet.cell(row=7, column=7, value="전체")
        
    print(f"테스트케이스가 다음 파일로 저장되었습니다: {file_path}")
    return file_path

def main():
    """메인 함수"""
    print("스킬 시스템 아이템 장착 테스트케이스를 생성합니다...")
    testcases = generate_skill_equipment_testcases()
    output_path = export_to_excel(testcases)
    print(f"테스트케이스 생성 완료! 총 {len(testcases)}개의 테스트케이스가 생성되었습니다.")
    print(f"파일 위치: {os.path.abspath(output_path)}")

if __name__ == "__main__":
    main()